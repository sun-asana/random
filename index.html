<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Wheel Ultra | sun-asana</title>
    <style>
        :root { --bg-color: #0a0a12; --panel-bg: #16213e; --neon: #ff00ff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-color); color: #fff; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 350px; background: var(--panel-bg); padding: 20px; box-shadow: 2px 0 15px rgba(0,0,0,0.5); overflow-y: auto; border-right: 1px solid #334; display: flex; flex-direction: column; gap: 15px; z-index: 100; }
        .main { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle, #1a1a2e 0%, #05050a 100%); position: relative; }
        h2 { color: #00d2ff; text-transform: uppercase; font-size: 18px; margin: 0; }
        .form-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 12px; color: #aaa; }
        .color-tools { display: flex; gap: 10px; align-items: center; }
        #mainColor { width: 50px; height: 50px; border: none; background: none; cursor: pointer; }
        input[type="text"], textarea { background: #0f3460; border: 1px solid #334; color: white; padding: 8px; border-radius: 5px; width: 100%; box-sizing: border-box; }
        button { padding: 12px; background: #e94560; border: none; color: white; font-weight: bold; cursor: pointer; border-radius: 5px; margin-top: 10px; transition: 0.3s; }
        button:hover { background: #ff4d6d; box-shadow: 0 0 15px #e94560; }
        #codeOutput { height: 80px; font-family: monospace; font-size: 10px; background: #000; color: #0f0; margin-top: 10px; }
        .winner-display { margin-top: 20px; font-size: 36px; font-weight: bold; min-height: 50px; color: #fff; text-align: center; }
        .checkbox-group { flex-direction: row; align-items: center; gap: 10px; display: flex; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>üé° Neon Editor v4.0</h2>
    <div class="form-group">
        <label>–≠–ª–µ–º–µ–Ω—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
        <textarea id="items" oninput="updatePreview()">–ë—É–º–∞–≥–∏, –¢—Ä–æ–ø–∏–Ω–∫–∏, –ö–≤–∞—Ä—Ç–∏—Ä—ã, –ö–ª–µ—Ç–æ—á–∫–∏, –¢–∞—Ä–∏—Ñ—ã, –®–∏–Ω—ã, –£—á–∞—Å—Ç–∫–∏</textarea>
    </div>
    <div class="form-group">
        <label>–¶–≤–µ—Ç –Ω–µ–æ–Ω–∞:</label>
        <div class="color-tools">
            <input type="color" id="mainColor" value="#ff00ff" oninput="syncColor(this.value)">
            <input type="text" id="colorHex" value="#ff00ff" oninput="syncColor(this.value)">
        </div>
    </div>
    <div class="form-group checkbox-group">
        <input type="checkbox" id="removeWinner" onchange="updatePreview()">
        <label for="removeWinner" style="cursor:pointer; color:#fff; font-size: 13px;">–£–¥–∞–ª—è—Ç—å –≤—ã–ø–∞–≤—à–∏–π —Å–µ–∫—Ç–æ—Ä</label>
    </div>
    <button onclick="copyCode()">üöÄ –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è Genially</button>
    <textarea id="codeOutput" readonly></textarea>
</div>

<div class="main">
    <canvas id="previewCanvas" width="600" height="600"></canvas>
    <div id="winnerName" class="winner-display"></div>
</div>

<script>
    const canvas = document.getElementById('previewCanvas');
    const ctx = canvas.getContext('2d');
    const mainColorInput = document.getElementById('mainColor');
    const hexInput = document.getElementById('colorHex');
    const winnerDisplay = document.getElementById('winnerName');
    const removeCheck = document.getElementById('removeWinner');
    
    let angle = 0;
    let isSpinning = false;
    let currentSectors = [];

    function adj(hex, mag) {
        hex = hex.replace('#', '');
        let r = Math.min(255, Math.max(0, parseInt(hex.substring(0,2), 16) * mag));
        let g = Math.min(255, Math.max(0, parseInt(hex.substring(2,4), 16) * mag));
        let b = Math.min(255, Math.max(0, parseInt(hex.substring(4,6), 16) * mag));
        return `rgb(${Math.round(r)},${Math.round(g)},${Math.round(b)})`;
    }

    function syncColor(val) {
        if(/^#[0-9A-F]{6}$/i.test(val)) {
            mainColorInput.value = val;
            hexInput.value = val;
            document.documentElement.style.setProperty('--neon', val);
            updatePreview();
        }
    }

    function render(currentAngle, sectors) {
        const base = mainColorInput.value;
        const num = sectors.length;
        const arc = (Math.PI * 2) / num;
        const cx = 300; const cy = 300; const rad = 250;
        
        ctx.clearRect(0,0,600,600);
        if(num === 0) return;

        sectors.forEach((text, i) => {
            const a = currentAngle + i * arc;
            const g = ctx.createRadialGradient(cx, cy, 0, cx, cy, rad);
            g.addColorStop(0, adj(base, 0.4));
            g.addColorStop(1, adj(base, 1.1));
            
            ctx.beginPath(); ctx.fillStyle = g; ctx.moveTo(cx, cy);
            ctx.arc(cx, cy, rad, a, a + arc); ctx.fill();
            ctx.strokeStyle = adj(base, 1.8); ctx.lineWidth = 2; ctx.stroke();

            ctx.save(); ctx.translate(cx, cy); ctx.rotate(a + arc / 2);
            ctx.fillStyle = "#fff"; ctx.font = "bold 18px sans-serif"; ctx.textAlign = "right";
            ctx.fillText(text, rad - 30, 7); ctx.restore();
        });

        ctx.beginPath(); ctx.arc(cx, cy, rad, 0, Math.PI * 2);
        ctx.strokeStyle = adj(base, 0.5); ctx.lineWidth = 15;
        ctx.shadowBlur = 25; ctx.shadowColor = base; ctx.stroke();
        ctx.shadowBlur = 0;

        ctx.fillStyle = "#fff"; ctx.shadowBlur = 15; ctx.shadowColor = "#fff";
        ctx.beginPath(); ctx.moveTo(cx - 25, 10); ctx.lineTo(cx + 25, 10); ctx.lineTo(cx, 60); ctx.fill();
        ctx.shadowBlur = 0;
    }

    function spin() {
        if (isSpinning || currentSectors.length === 0) return;
        isSpinning = true;
        winnerDisplay.innerText = "";
        winnerDisplay.classList.remove('winner-active');
        
        let rot = Math.random() * (Math.PI * 2) + (Math.PI * 12); 
        let cur = 0;

        const anim = () => {
            let step = (rot - cur) * 0.04 + 0.005;
            angle += step;
            cur += step;
            render(angle, currentSectors);

            if (cur < rot) {
                requestAnimationFrame(anim);
            } else {
                isSpinning = false;
                const arc = (Math.PI * 2) / currentSectors.length;
                const norm = (angle % (Math.PI * 2));
                const idx = Math.floor((Math.PI * 1.5 - norm + Math.PI * 20) % (Math.PI * 2) / arc);
                
                winnerDisplay.innerText = currentSectors[idx];
                winnerDisplay.style.setProperty('--n', mainColorInput.value);
                // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
                void winnerDisplay.offsetWidth; 
                winnerDisplay.style.animation = "neon-flicker 2s ease-in-out infinite";

                if (removeCheck.checked && currentSectors.length > 1) {
                    setTimeout(() => {
                        currentSectors.splice(idx, 1);
                        render(angle, currentSectors);
                    }, 1200);
                }
            }
        };
        anim();
    }

    function generateFinalCode() {
        const items = document.getElementById('items').value.split(',').map(s => s.trim()).filter(s => s !== "");
        const color = mainColorInput.value;
        const remove = removeCheck.checked;
        
        const finalMarkup = `
<div style="background:transparent; display:flex; flex-direction:column; align-items:center; width:100%; font-family: sans-serif;">
    <style>
        @keyframes nF {
            0%, 100% { text-shadow: 0 0 10px \${color}, 0 0 20px \${color}; opacity: 1; transform: scale(1.1); }
            50% { text-shadow: 0 0 20px \${color}, 0 0 40px \${color}; opacity: 0.9; transform: scale(1.15); }
            10%, 12%, 15% { opacity: 0.4; }
        }
        .win { animation: nF 2s ease-in-out infinite; }
    </style>
    <canvas id="wG" width="600" height="600" style="width:100%; max-width:600px; cursor:pointer;"></canvas>
    <div id="st" style="color:#fff; font-weight:bold; font-size:36px; margin-top:15px; min-height:50px; text-align:center; transition: 0.3s;"></div>
</div>
<script>
(function(){
    const c = document.getElementById('wG'); const ctx = c.getContext('2d');
    const st = document.getElementById('st');
    let s = ${JSON.stringify(items)};
    let a = 0; let sp = false; const b = "${color}";

    function ad(h, m) {
        h = h.replace('#','');
        let r = Math.min(255, parseInt(h.substring(0,2),16)*m);
        let g = Math.min(255, parseInt(h.substring(2,4),16)*m);
        let b = Math.min(255, parseInt(h.substring(4,6),16)*m);
        return "rgb("+Math.round(r)+","+Math.round(g)+","+Math.round(b)+")";
    }

    function d() {
        const arc = (Math.PI*2)/s.length;
        ctx.clearRect(0,0,600,600);
        s.forEach((t, i) => {
            const an = a + i*arc;
            const g = ctx.createRadialGradient(300,300,0,300,300,250);
            g.addColorStop(0, ad(b, 0.4)); g.addColorStop(1, ad(b, 1.1));
            ctx.beginPath(); ctx.fillStyle = g; ctx.moveTo(300,300);
            ctx.arc(300,300,250, an, an+arc); ctx.fill();
            ctx.strokeStyle = ad(b, 1.8); ctx.lineWidth=2; ctx.stroke();
            ctx.save(); ctx.translate(300,300); ctx.rotate(an+arc/2);
            ctx.fillStyle="#fff"; ctx.font="bold 18px sans-serif"; ctx.textAlign="right";
            ctx.fillText(t, 220, 7); ctx.restore();
        });
        ctx.beginPath(); ctx.arc(300,300,250,0,Math.PI*2);
        ctx.strokeStyle=ad(b, 0.5); ctx.lineWidth=15; ctx.shadowBlur=25; ctx.shadowColor=b; ctx.stroke();
        ctx.shadowBlur=0; ctx.fillStyle="#fff"; ctx.shadowBlur=15; ctx.shadowColor="#fff";
        ctx.beginPath(); ctx.moveTo(275,10); ctx.lineTo(325,10); ctx.lineTo(300,60); ctx.fill();
    }

    c.onclick = () => {
        if(sp || s.length < 1) return; sp = true; st.innerText = ""; st.classList.remove('win');
        let rot = Math.random()*(Math.PI*2) + (Math.PI*12); let cur = 0;
        const anm = () => {
            let step = (rot-cur)*0.04 + 0.005; a += step; cur += step;
            d();
            if(cur < rot) requestAnimationFrame(anm);
            else {
                sp = false;
                const arc = (Math.PI*2)/s.length;
                const idx = Math.floor((Math.PI*1.5 - (a%(Math.PI*2)) + Math.PI*20)%(Math.PI*2)/arc);
                st.innerText = s[idx];
                st.classList.add('win');
                if(${remove} && s.length > 1) {
                    setTimeout(() => { s.splice(idx,1); d(); }, 1200);
                }
            }
        }; anm();
    }; d();
})();
<\/script>`.replace(/\${color}/g, color);
        document.getElementById('codeOutput').value = finalMarkup;
    }

    function copyCode() {
        const out = document.getElementById("codeOutput");
        out.select();
        document.execCommand("copy");
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –í—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ Genially.");
    }

    function updatePreview() { 
        currentSectors = document.getElementById('items').value.split(',').map(s => s.trim()).filter(s => s !== "");
        render(angle, currentSectors);
        generateFinalCode();
    }
    
    canvas.onclick = spin;
    updatePreview();
</script>

</body>
</html>
